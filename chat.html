<!DOCTYPE html>
<html>
<head>
  <title>Chat</title>
  <script src="helper.js"></script>
</head>
<body>

<script>
const user = requireLogin();
loadTopbar();
</script>

<h1>Chat</h1>

<div id="messages"></div>
<input id="msg" placeholder="Type message">
<button onclick="send()">Send</button>
<p id="typing"></p>

<script>
let messages = JSON.parse(localStorage.getItem("chat")) || [];

function render() {
  messagesDiv.innerHTML = messages.map(m => `<p><b>${m.u}:</b> ${m.t}</p>`).join("");
}

function send() {
  messages.push({u:user, t:msg.value});
  localStorage.setItem("chat", JSON.stringify(messages));
  msg.value = "";
  render();
}

render();
</script>

</body>
</html>
