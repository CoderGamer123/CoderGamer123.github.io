// Load user data
let user = loadUserData();
let coins = user.coins;
let characters = user.characters;
let packsOpened = user.packsOpened;

document.getElementById("coinsDisplay").innerText = "Coins: " + coins;

// In buyPack function
function buyPack(cost){
  if(coins < cost){ alert("Not enough coins!"); return; }

  coins -= cost;
  packsOpened += 1;

  // Pick random character (same as before)
  let roll = Math.random();
  let chosen;
  if(roll < 0.5) chosen = possibleCharacters[0];        // common
  else if(roll < 0.85) chosen = possibleCharacters[2];  // rare
  else chosen = possibleCharacters[3];                  // chroma

  const id = chosen.name + "_" + chosen.rarity;
  if(characters[id]) characters[id].count += 1;
  else characters[id] = {count:1, rarity:chosen.rarity, img:chosen.img, name:chosen.name};

  // Save back to user
  user.coins = coins;
  user.characters = characters;
  user.packsOpened = packsOpened;
  saveUserData(user);

  document.getElementById("coinsDisplay").innerText = "Coins: " + coins;
  document.getElementById("lastPackResult").innerHTML = `You got ${chosen.name} (${chosen.rarity})!`;
}

